machine:
  python:
    version: 3.5.1

dependencies:
  override:
    - pip install -U bootstrapper pip wheel
    - make
    - make setup-pyenv

  pre:
    - sudo apt-get install -y language-pack-uk
    - pyenv install 3.4.5
    - pyenv install 3.5.2

  cache_directories:
    - /opt/circleci/.pyenv/versions/3.4.5
    - /opt/circleci/.pyenv/versions/3.5.2

test:
  override:
    - TEST_ARGS="--with-xunit --cover-html --cover-html-dir=$CIRCLE_ARTIFACTS/coverage" make test

  post:
    - "coveralls || :"
    - mkdir -p $CIRCLE_TEST_REPORTS/junit/
    - "[ -r nosetests.xml ] && mv nosetests.xml $CIRCLE_TEST_REPORTS/junit/ || :"
